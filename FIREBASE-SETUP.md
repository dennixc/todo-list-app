# ğŸ”¥ Firebase è¨­å®šæŒ‡å—

## âœ… å·²å®Œæˆçš„æ­¥é©Ÿ

1. âœ… Firebase å°ˆæ¡ˆå»ºç«‹å®Œæˆ
2. âœ… Firestore Database å·²å•Ÿç”¨
3. âœ… Firebase é…ç½®å·²æ•´åˆåˆ°æ‡‰ç”¨ç¨‹å¼
4. âœ… æ‰€æœ‰ç¨‹å¼ç¢¼å·²æ›´æ–°ç‚ºä½¿ç”¨ Firebase

---

## âš ï¸ é‡è¦ï¼šè¨­å®š Firestore å®‰å…¨è¦å‰‡

ç›®å‰ Firestore è™•æ–¼ã€Œæ¸¬è©¦æ¨¡å¼ã€ï¼Œ**ä»»ä½•äººéƒ½å¯ä»¥è®€å¯«è³‡æ–™**ã€‚
åœ¨æ­£å¼ä½¿ç”¨å‰ï¼Œæˆ‘å€‘éœ€è¦è¨­å®šå®‰å…¨è¦å‰‡ã€‚

### æ­¥é©Ÿ 1ï¼šå‰å¾€ Firebase Console

1. è¨ªå•ï¼šhttps://console.firebase.google.com/
2. é¸æ“‡ä½ çš„å°ˆæ¡ˆï¼š`todo-list-app-3b98d`
3. å·¦å´é¸å–® â†’ **Firestore Database**
4. é»æ“Šé ‚éƒ¨çš„ **è¦å‰‡ï¼ˆRulesï¼‰** æ¨™ç±¤

### æ­¥é©Ÿ 2ï¼šæ›´æ–°å®‰å…¨è¦å‰‡

ç›®å‰çš„è¦å‰‡ï¼ˆæ¸¬è©¦æ¨¡å¼ï¼‰ï¼š
```
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /{document=**} {
      allow read, write: if request.time < timestamp.date(2024, 3, 18);
    }
  }
}
```

**ç¬¬äºŒéšæ®µï¼ˆé–‹æ”¾è®€å¯«ï¼‰ï¼š**
```
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // å…è¨±æ‰€æœ‰äººè®€å¯« todos é›†åˆï¼ˆç¬¬äºŒéšæ®µï¼‰
    match /todos/{todoId} {
      allow read, write: if true;
    }
  }
}
```

âš ï¸ **æ³¨æ„**ï¼šé€™å€‹è¦å‰‡å…è¨±ä»»ä½•äººè®€å¯«è³‡æ–™ã€‚
åœ¨ç¬¬ä¸‰éšæ®µåŠ å…¥ä½¿ç”¨è€…èªè­‰å¾Œï¼Œæˆ‘å€‘æœƒæ”¹ç‚ºæ›´å®‰å…¨çš„è¦å‰‡ã€‚

**ç¬¬ä¸‰éšæ®µï¼ˆä½¿ç”¨è€…èªè­‰å¾Œï¼‰ï¼š**
```
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // åªå…è¨±å·²ç™»å…¥çš„ä½¿ç”¨è€…å­˜å–è‡ªå·±çš„è³‡æ–™
    match /todos/{todoId} {
      allow read, write: if request.auth != null
        && request.auth.uid == resource.data.userId;
      allow create: if request.auth != null;
    }
  }
}
```

### æ­¥é©Ÿ 3ï¼šç™¼å¸ƒè¦å‰‡

1. è¤‡è£½ä¸Šé¢ã€Œç¬¬äºŒéšæ®µã€çš„è¦å‰‡
2. è²¼åˆ° Firebase Console çš„è¦å‰‡ç·¨è¼¯å™¨
3. é»æ“Š **ç™¼å¸ƒï¼ˆPublishï¼‰** æŒ‰éˆ•
4. ç¢ºèªç™¼å¸ƒ

---

## ğŸ“Š Firestore è³‡æ–™çµæ§‹

### todos é›†åˆ

æ¯å€‹æ–‡ä»¶åŒ…å«ä»¥ä¸‹æ¬„ä½ï¼š

```javascript
{
  text: "è²·èœ",              // String - ä»»å‹™å…§å®¹
  completed: false,          // Boolean - æ˜¯å¦å®Œæˆ
  createdAt: Timestamp,      // Timestamp - å»ºç«‹æ™‚é–“
  order: 0                   // Number - æ’åºé †åº
}
```

æ–‡ä»¶ ID ç”± Firebase è‡ªå‹•ç”Ÿæˆï¼ˆä¾‹å¦‚ï¼š`abc123xyz`ï¼‰

### ç¬¬ä¸‰éšæ®µæœƒåŠ å…¥çš„æ¬„ä½ï¼š

```javascript
{
  userId: "user_xyz",        // String - ä½¿ç”¨è€… ID
  text: "è²·èœ",
  completed: false,
  createdAt: Timestamp,
  updatedAt: Timestamp,      // æ›´æ–°æ™‚é–“
  order: 0
}
```

---

## ğŸ§ª æ¸¬è©¦ Firebase æ•´åˆ

### æœ¬åœ°æ¸¬è©¦

```bash
# å•Ÿå‹•æœ¬åœ°ä¼ºæœå™¨
npx http-server -p 8080 -o
```

### æª¢æŸ¥æ¸…å–®

1. **é–‹å•Ÿæ‡‰ç”¨ç¨‹å¼**
   - è¨ªå• http://localhost:8080

2. **æª¢æŸ¥ä¸»æ§å°ï¼ˆF12 â†’ Consoleï¼‰**
   - âœ… æ‡‰è©²çœ‹åˆ°ï¼š`ğŸ”¥ Firebase åˆå§‹åŒ–æˆåŠŸ`
   - âœ… æ‡‰è©²çœ‹åˆ°ï¼š`ğŸš€ Firebase ç‰ˆæœ¬è¼‰å…¥å®Œæˆ`
   - âœ… æ‡‰è©²çœ‹åˆ°ï¼š`ğŸ”„ è¼‰å…¥å¾…è¾¦äº‹é …...`
   - âœ… æ‡‰è©²çœ‹åˆ°ï¼š`âœ… è¼‰å…¥å®Œæˆï¼Œå…± X å€‹ä»»å‹™`

3. **æ¸¬è©¦æ–°å¢ä»»å‹™**
   - è¼¸å…¥ä»»å‹™å…§å®¹
   - é»æ“Šã€Œæ–°å¢ã€
   - âœ… æ‡‰è©²ç«‹å³å‡ºç¾åœ¨æ¸…å–®ä¸­
   - âœ… æŒ‰éˆ•æœƒçŸ­æš«é¡¯ç¤ºã€Œæ–°å¢ä¸­...ã€

4. **æª¢æŸ¥ Firebase Console**
   - å‰å¾€ Firestore Database â†’ è³‡æ–™ï¼ˆDataï¼‰æ¨™ç±¤
   - âœ… æ‡‰è©²çœ‹åˆ° `todos` é›†åˆ
   - âœ… æ‡‰è©²çœ‹åˆ°å‰›å‰›æ–°å¢çš„æ–‡ä»¶

5. **æ¸¬è©¦å³æ™‚åŒæ­¥**
   - é–‹å•Ÿå…©å€‹ç€è¦½å™¨è¦–çª—ï¼ˆæˆ–å…©å€‹è£ç½®ï¼‰
   - åœ¨ä¸€å€‹è¦–çª—æ–°å¢ä»»å‹™
   - âœ… å¦ä¸€å€‹è¦–çª—æ‡‰è©²è‡ªå‹•æ›´æ–°

6. **æ¸¬è©¦ç·¨è¼¯å’Œåˆªé™¤**
   - é»æ“Š âœï¸ ç·¨è¼¯ä»»å‹™
   - é»æ“Š ğŸ—‘ï¸ åˆªé™¤ä»»å‹™
   - âœ… æ‰€æœ‰æ“ä½œéƒ½æ‡‰è©²æ­£å¸¸é‹ä½œ

---

## ğŸ” é™¤éŒ¯æŒ‡å—

### å•é¡Œ 1ï¼šç„¡æ³•é€£æ¥åˆ° Firebase

**ç—‡ç‹€ï¼š**
- ä¸»æ§å°é¡¯ç¤ºéŒ¯èª¤
- è¼‰å…¥æŒ‡ç¤ºå™¨ä¸€ç›´é¡¯ç¤º

**è§£æ±ºæ–¹æ¡ˆï¼š**
1. æª¢æŸ¥ Firebase é…ç½®æ˜¯å¦æ­£ç¢º
2. æª¢æŸ¥ç¶²è·¯é€£ç·š
3. ç¢ºèª Firestore Database å·²å•Ÿç”¨
4. æª¢æŸ¥ç€è¦½å™¨ä¸»æ§å°çš„è©³ç´°éŒ¯èª¤è¨Šæ¯

### å•é¡Œ 2ï¼šCORS éŒ¯èª¤

**ç—‡ç‹€ï¼š**
- ä¸»æ§å°é¡¯ç¤º CORS ç›¸é—œéŒ¯èª¤

**è§£æ±ºæ–¹æ¡ˆï¼š**
1. ç¢ºèªä½¿ç”¨ HTTP/HTTPSï¼ˆä¸æ˜¯ file://ï¼‰
2. ä½¿ç”¨ `npx http-server` æˆ–å…¶ä»–æœ¬åœ°ä¼ºæœå™¨
3. æª¢æŸ¥ Firebase å°ˆæ¡ˆè¨­å®šä¸­çš„æˆæ¬Šç¶²åŸŸ

### å•é¡Œ 3ï¼šç„¡æ³•æ–°å¢è³‡æ–™

**ç—‡ç‹€ï¼š**
- é»æ“Šæ–°å¢å¾Œæ²’æœ‰åæ‡‰
- ä¸»æ§å°é¡¯ç¤º "Missing or insufficient permissions"

**è§£æ±ºæ–¹æ¡ˆï¼š**
1. æª¢æŸ¥ Firestore å®‰å…¨è¦å‰‡
2. ç¢ºèªè¦å‰‡å·²æ­£ç¢ºç™¼å¸ƒ
3. å˜—è©¦æ›´æ–°ç‚ºé–‹æ”¾çš„æ¸¬è©¦è¦å‰‡ï¼ˆè¦‹ä¸Šæ–¹ï¼‰

### å•é¡Œ 4ï¼šè³‡æ–™æœªå³æ™‚æ›´æ–°

**ç—‡ç‹€ï¼š**
- æ–°å¢è³‡æ–™å¾Œéœ€è¦æ‰‹å‹•é‡æ–°æ•´ç†æ‰èƒ½çœ‹åˆ°

**è§£æ±ºæ–¹æ¡ˆï¼š**
1. æª¢æŸ¥ `onSnapshot` ç›£è½å™¨æ˜¯å¦æ­£å¸¸é‹ä½œ
2. æª¢æŸ¥ä¸»æ§å°æ˜¯å¦æœ‰éŒ¯èª¤è¨Šæ¯
3. ç¢ºèªæ²’æœ‰é˜²ç«ç‰†å°é– WebSocket é€£ç·š

---

## ğŸ“¦ Firebase ç”¨é‡å’Œé™åˆ¶

### å…è²»æ–¹æ¡ˆï¼ˆSpark Planï¼‰é™åˆ¶ï¼š

- **å„²å­˜ç©ºé–“**ï¼š1 GB
- **æ–‡ä»¶è®€å–**ï¼š50,000 æ¬¡/å¤©
- **æ–‡ä»¶å¯«å…¥**ï¼š20,000 æ¬¡/å¤©
- **æ–‡ä»¶åˆªé™¤**ï¼š20,000 æ¬¡/å¤©
- **ç¶²è·¯æµé‡**ï¼š10 GB/æœˆ

### é ä¼°ä½¿ç”¨é‡ï¼š

ä¸€å€‹æ™®é€šä½¿ç”¨è€…æ¯å¤©ï¼š
- æ–°å¢ 10 å€‹ä»»å‹™ = 10 æ¬¡å¯«å…¥
- å®Œæˆ/ç·¨è¼¯ 20 æ¬¡ = 20 æ¬¡å¯«å…¥
- é é¢è¼‰å…¥ 5 æ¬¡ = 50 æ¬¡è®€å–ï¼ˆå‡è¨­ 10 å€‹ä»»å‹™ï¼‰

**ç¸½è¨ˆï¼š30 æ¬¡å¯«å…¥ï¼Œ50 æ¬¡è®€å–/å¤©/ä½¿ç”¨è€…**

å…è²»æ–¹æ¡ˆå¯æ”¯æ´ï¼š
- **å¯«å…¥**ï¼šç´„ 600 å€‹ä½¿ç”¨è€…/å¤©
- **è®€å–**ï¼šç´„ 1000 å€‹ä½¿ç”¨è€…/å¤©

å°æ–¼å€‹äººæˆ–å°å‹å°ˆæ¡ˆä¾†èªªï¼Œå…è²»æ–¹æ¡ˆå®Œå…¨è¶³å¤ ï¼

---

## ğŸš€ ä¸‹ä¸€æ­¥

å®Œæˆ Firebase è¨­å®šå’Œæ¸¬è©¦å¾Œï¼š

1. âœ… æœ¬åœ°æ¸¬è©¦æ‰€æœ‰åŠŸèƒ½
2. âœ… éƒ¨ç½²åˆ° Vercel
3. âœ… è·¨è£ç½®æ¸¬è©¦å³æ™‚åŒæ­¥
4. ğŸ”„ é€²å…¥ç¬¬ä¸‰éšæ®µï¼šä½¿ç”¨è€…èªè­‰

---

## ğŸ’¡ å°æŠ€å·§

### æŸ¥çœ‹å³æ™‚è³‡æ–™

åœ¨ Firebase Console çš„ Firestore Database é é¢ï¼Œä½ å¯ä»¥ï¼š
- å³æ™‚æŸ¥çœ‹æ‰€æœ‰è³‡æ–™
- æ‰‹å‹•æ–°å¢/ç·¨è¼¯/åˆªé™¤æ–‡ä»¶
- åŒ¯å‡ºè³‡æ–™
- æŸ¥çœ‹ç´¢å¼•

### æ•ˆèƒ½å„ªåŒ–

ç¬¬äºŒéšæ®µä½¿ç”¨å³æ™‚ç›£è½ï¼ˆ`onSnapshot`ï¼‰ï¼Œé€™æœƒæŒçºŒå ç”¨ä¸€å€‹é€£ç·šã€‚
å¦‚æœä¸éœ€è¦å³æ™‚æ›´æ–°ï¼Œå¯ä»¥æ”¹ç”¨ `getDocs` æ‰‹å‹•è¼‰å…¥ï¼š

```javascript
// å³æ™‚ç›£è½ï¼ˆæ¨è–¦ï¼‰
onSnapshot(q, (snapshot) => { ... });

// æ‰‹å‹•è¼‰å…¥ï¼ˆè¼ƒçœè³‡æºï¼‰
const snapshot = await getDocs(q);
```

### é›¢ç·šæ”¯æ´

Firestore å…§å»ºé›¢ç·šå¿«å–ï¼
- é›¢ç·šæ™‚ä»å¯æ“ä½œ
- è³‡æ–™æš«å­˜åœ¨æœ¬åœ°
- ç¶²è·¯æ¢å¾©å¾Œè‡ªå‹•åŒæ­¥

é€™èˆ‡æˆ‘å€‘çš„ PWA é›¢ç·šåŠŸèƒ½å®Œç¾é…åˆï¼

---

**è¨­å®šå®Œæˆå¾Œï¼Œè«‹å‘Šè¨´æˆ‘é€²è¡Œæ¸¬è©¦ï¼** ğŸ”¥
